/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Khoj
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  resultsCount: 6,
  khojUrl: "http://localhost:8000",
  connectedToBackend: false
};
var KhojSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("small", { text: this.getBackendStatusMessage() });
    new import_obsidian.Setting(containerEl).setName("Khoj URL").setDesc("The URL of the Khoj backend").addText((text) => text.setValue(`${this.plugin.settings.khojUrl}`).onChange(async (value) => {
      var _a;
      this.plugin.settings.khojUrl = value.trim();
      await this.plugin.saveSettings();
      (_a = containerEl.firstElementChild) == null ? void 0 : _a.setText(this.getBackendStatusMessage());
    }));
    new import_obsidian.Setting(containerEl).setName("Results Count").setDesc("The number of search results to show").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.resultsCount).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.resultsCount = value;
      await this.plugin.saveSettings();
    }));
    let indexVaultSetting = new import_obsidian.Setting(containerEl);
    indexVaultSetting.setName("Index Vault").setDesc("Manually force Khoj to re-index your Obsidian Vault").addButton((button) => button.setButtonText("Update").setCta().onClick(async () => {
      button.setButtonText("Updating...");
      button.removeCta();
      indexVaultSetting = indexVaultSetting.setDisabled(true);
      await (0, import_obsidian.request)(`${this.plugin.settings.khojUrl}/api/update?t=markdown&force=true`);
      new import_obsidian.Notice("\u2705 Updated Khoj index.");
      button.setButtonText("Update");
      button.setCta();
      indexVaultSetting = indexVaultSetting.setDisabled(false);
    }));
  }
  getBackendStatusMessage() {
    return !this.plugin.settings.connectedToBackend ? "\u2757Disconnected from Khoj backend. Ensure Khoj backend is running and Khoj URL is correctly set below." : "\u2705 Connected to Khoj backend.";
  }
};

// src/modal.ts
var import_obsidian2 = require("obsidian");
var KhojModal = class extends import_obsidian2.SuggestModal {
  constructor(app, setting, find_similar_notes = false) {
    super(app);
    this.rerank = false;
    this.app = app;
    this.setting = setting;
    this.find_similar_notes = find_similar_notes;
    this.inputEl.hidden = this.find_similar_notes;
    this.scope.register(["Mod"], "Enter", async () => {
      this.rerank = true;
      this.inputEl.dispatchEvent(new Event("input"));
      this.rerank = false;
    });
    const modalInstructions = [
      {
        command: "\u2191\u2193",
        purpose: "to navigate"
      },
      {
        command: "\u21B5",
        purpose: "to open"
      },
      {
        command: import_obsidian2.Platform.isMacOS ? "cmd \u21B5" : "ctrl \u21B5",
        purpose: "to rerank"
      },
      {
        command: "esc",
        purpose: "to dismiss"
      }
    ];
    this.setInstructions(modalInstructions);
    this.setPlaceholder("Search with Khoj \u{1F985}...");
  }
  async onOpen() {
    if (this.find_similar_notes) {
      let file = this.app.workspace.getActiveFile();
      if (file && file.extension === "md") {
        this.rerank = true;
        this.inputEl.value = await this.app.vault.read(file).then((file_str) => file_str.slice(0, 8e3));
        this.inputEl.dispatchEvent(new Event("input"));
        this.rerank = false;
      } else {
        this.resultContainerEl.setText("Cannot find similar notes for non-markdown files");
      }
    }
  }
  async getSuggestions(query) {
    let encodedQuery = encodeURIComponent(query);
    let searchUrl = `${this.setting.khojUrl}/api/search?q=${encodedQuery}&n=${this.setting.resultsCount}&r=${this.rerank}&t=markdown`;
    let response = await (0, import_obsidian2.request)(searchUrl);
    let data = JSON.parse(response);
    let results = data.filter((result) => {
      var _a;
      return !this.find_similar_notes || !result.additional.file.endsWith((_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path);
    }).map((result) => {
      return { entry: result.entry, file: result.additional.file };
    });
    return results;
  }
  async renderSuggestion(result, el) {
    let words_to_render = 30;
    let entry_words = result.entry.split(" ");
    let entry_snipped_indicator = entry_words.length > words_to_render ? " **...**" : "";
    let snipped_entry = entry_words.slice(0, words_to_render).join(" ");
    import_obsidian2.MarkdownRenderer.renderMarkdown(snipped_entry + entry_snipped_indicator, el, null, null);
  }
  async onChooseSuggestion(result, _) {
    const mdFiles = this.app.vault.getMarkdownFiles();
    let file_match = mdFiles.sort((a, b) => b.path.length - a.path.length).find((file) => result.file.endsWith(file.path));
    if (file_match) {
      let resultHeading = result.entry.split("\n", 1)[0];
      let linkToEntry = `${file_match.path}${resultHeading}`;
      this.app.workspace.openLinkText(linkToEntry, "");
      console.log(`Link: ${linkToEntry}, File: ${file_match.path}, Heading: ${resultHeading}`);
    }
  }
};

// src/utils.ts
var import_obsidian3 = require("obsidian");
function getVaultAbsolutePath(vault) {
  let adaptor = vault.adapter;
  if (adaptor instanceof import_obsidian3.FileSystemAdapter) {
    return adaptor.getBasePath();
  }
  return "";
}
async function configureKhojBackend(vault, setting, notify = true) {
  let mdInVault = `${getVaultAbsolutePath(vault)}/**/*.md`;
  let khojConfigUrl = `${setting.khojUrl}/api/config/data`;
  let khoj_already_configured = await (0, import_obsidian3.request)(khojConfigUrl).then((response) => {
    setting.connectedToBackend = true;
    return response !== "null";
  }).catch((error) => {
    setting.connectedToBackend = false;
    if (notify)
      new import_obsidian3.Notice(`\u2757\uFE0FEnsure Khoj backend is running and Khoj URL is pointing to it in the plugin settings.

${error}`);
  });
  if (!setting.connectedToBackend)
    return;
  let indexName = getVaultAbsolutePath(vault).replace(/\//g, "_").replace(/ /g, "_");
  let khojDefaultIndexDirectory = await (0, import_obsidian3.request)(`${khojConfigUrl}/default`).then((response) => JSON.parse(response)).then((data) => {
    return getIndexDirectoryFromBackendConfig(data);
  });
  await (0, import_obsidian3.request)(khoj_already_configured ? khojConfigUrl : `${khojConfigUrl}/default`).then((response) => JSON.parse(response)).then((data) => {
    if (!khoj_already_configured) {
      data["content-type"] = {
        "markdown": {
          "input-filter": [mdInVault],
          "input-files": null,
          "embeddings-file": `${khojDefaultIndexDirectory}/${indexName}.pt`,
          "compressed-jsonl": `${khojDefaultIndexDirectory}/${indexName}.jsonl.gz`
        }
      };
      delete data["processor"];
      updateKhojBackend(setting.khojUrl, data);
      console.log(`Khoj: Created khoj backend config:
${JSON.stringify(data)}`);
    } else if (!data["content-type"]["markdown"]) {
      data["content-type"]["markdown"] = {
        "input-filter": [mdInVault],
        "input-files": null,
        "embeddings-file": `${khojDefaultIndexDirectory}/${indexName}.pt`,
        "compressed-jsonl": `${khojDefaultIndexDirectory}/${indexName}.jsonl.gz`
      };
      updateKhojBackend(setting.khojUrl, data);
      console.log(`Khoj: Added markdown config to khoj backend config:
${JSON.stringify(data["content-type"])}`);
    } else if (data["content-type"]["markdown"]["input-filter"].length != 1 || data["content-type"]["markdown"]["input-filter"][0] !== mdInVault) {
      let khojIndexDirectory = getIndexDirectoryFromBackendConfig(data);
      data["content-type"]["markdown"] = {
        "input-filter": [mdInVault],
        "input-files": null,
        "embeddings-file": `${khojIndexDirectory}/${indexName}.pt`,
        "compressed-jsonl": `${khojIndexDirectory}/${indexName}.jsonl.gz`
      };
      updateKhojBackend(setting.khojUrl, data);
      console.log(`Khoj: Updated markdown config in khoj backend config:
${JSON.stringify(data["content-type"]["markdown"])}`);
    }
  }).catch((error) => {
    if (notify)
      new import_obsidian3.Notice(`\u2757\uFE0FFailed to configure Khoj backend. Contact developer on Github.

Error: ${error}`);
  });
}
async function updateKhojBackend(khojUrl, khojConfig) {
  let requestContent = {
    url: `${khojUrl}/api/config/data`,
    body: JSON.stringify(khojConfig),
    method: "POST",
    contentType: "application/json"
  };
  await (0, import_obsidian3.request)(requestContent).then((_) => (0, import_obsidian3.request)(`${khojUrl}/api/update?t=markdown`));
}
function getIndexDirectoryFromBackendConfig(khojConfig) {
  return khojConfig["content-type"]["markdown"]["embeddings-file"].split("/").slice(0, -1).join("/");
}

// src/main.ts
var Khoj = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    this.addCommand({
      id: "search",
      name: "Search",
      checkCallback: (checking) => {
        if (!checking && this.settings.connectedToBackend)
          new KhojModal(this.app, this.settings).open();
        return this.settings.connectedToBackend;
      }
    });
    this.addCommand({
      id: "similar",
      name: "Find similar notes",
      editorCheckCallback: (checking) => {
        if (!checking && this.settings.connectedToBackend)
          new KhojModal(this.app, this.settings, true).open();
        return this.settings.connectedToBackend;
      }
    });
    this.addRibbonIcon("search", "Khoj", (_) => {
      this.settings.connectedToBackend ? new KhojModal(this.app, this.settings).open() : new import_obsidian4.Notice(`\u2757\uFE0FEnsure Khoj backend is running and Khoj URL is pointing to it in the plugin settings`);
    });
    this.addSettingTab(new KhojSettingTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    await configureKhojBackend(this.app.vault, this.settings);
  }
  async saveSettings() {
    await configureKhojBackend(this.app.vault, this.settings, false).then(() => this.saveData(this.settings));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9tb2RhbC50cyIsICJzcmMvdXRpbHMudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE5vdGljZSwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgS2hvalNldHRpbmcsIEtob2pTZXR0aW5nVGFiLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnc3JjL3NldHRpbmdzJ1xuaW1wb3J0IHsgS2hvak1vZGFsIH0gZnJvbSAnc3JjL21vZGFsJ1xuaW1wb3J0IHsgY29uZmlndXJlS2hvakJhY2tlbmQgfSBmcm9tICcuL3V0aWxzJztcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLaG9qIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogS2hvalNldHRpbmc7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gQWRkIHNlYXJjaCBjb21tYW5kLiBJdCBjYW4gYmUgdHJpZ2dlcmVkIGZyb20gYW55d2hlcmVcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc2VhcmNoJyxcbiAgICAgICAgICAgIG5hbWU6ICdTZWFyY2gnLFxuICAgICAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZyAmJiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZClcbiAgICAgICAgICAgICAgICAgICAgbmV3IEtob2pNb2RhbCh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncykub3BlbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIHNpbWlsYXIgbm90ZXMgY29tbWFuZC4gSXQgY2FuIG9ubHkgYmUgdHJpZ2dlcmVkIGZyb20gdGhlIGVkaXRvclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdzaW1pbGFyJyxcbiAgICAgICAgICAgIG5hbWU6ICdGaW5kIHNpbWlsYXIgbm90ZXMnLFxuICAgICAgICAgICAgZWRpdG9yQ2hlY2tDYWxsYmFjazogKGNoZWNraW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZyAmJiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZClcbiAgICAgICAgICAgICAgICAgICAgbmV3IEtob2pNb2RhbCh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncywgdHJ1ZSkub3BlbigpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmNvbm5lY3RlZFRvQmFja2VuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGFuIGljb24gaW4gdGhlIGxlZnQgcmliYm9uLlxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ3NlYXJjaCcsICdLaG9qJywgKF86IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyB0aGUgaWNvbi5cbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuY29ubmVjdGVkVG9CYWNrZW5kXG4gICAgICAgICAgICAgICAgPyBuZXcgS2hvak1vZGFsKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKS5vcGVuKClcbiAgICAgICAgICAgICAgICA6IG5ldyBOb3RpY2UoYFx1Mjc1N1x1RkUwRkVuc3VyZSBLaG9qIGJhY2tlbmQgaXMgcnVubmluZyBhbmQgS2hvaiBVUkwgaXMgcG9pbnRpbmcgdG8gaXQgaW4gdGhlIHBsdWdpbiBzZXR0aW5nc2ApO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSBraG9qXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgS2hvalNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIC8vIExvYWQga2hvaiBvYnNpZGlhbiBwbHVnaW4gc2V0dGluZ3NcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cbiAgICAgICAgLy8gTG9hZCwgY29uZmlndXJlIGtob2ogc2VydmVyIHNldHRpbmdzXG4gICAgICAgIGF3YWl0IGNvbmZpZ3VyZUtob2pCYWNrZW5kKHRoaXMuYXBwLnZhdWx0LCB0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IGNvbmZpZ3VyZUtob2pCYWNrZW5kKHRoaXMuYXBwLnZhdWx0LCB0aGlzLnNldHRpbmdzLCBmYWxzZSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncykpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgUGx1Z2luU2V0dGluZ1RhYiwgcmVxdWVzdCwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBLaG9qIGZyb20gJ3NyYy9tYWluJztcblxuZXhwb3J0IGludGVyZmFjZSBLaG9qU2V0dGluZyB7XG4gICAgcmVzdWx0c0NvdW50OiBudW1iZXI7XG4gICAga2hvalVybDogc3RyaW5nO1xuICAgIGNvbm5lY3RlZFRvQmFja2VuZDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEtob2pTZXR0aW5nID0ge1xuICAgIHJlc3VsdHNDb3VudDogNixcbiAgICBraG9qVXJsOiAnaHR0cDovL2xvY2FsaG9zdDo4MDAwJyxcbiAgICBjb25uZWN0ZWRUb0JhY2tlbmQ6IGZhbHNlLFxufVxuXG5leHBvcnQgY2xhc3MgS2hvalNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEtob2o7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBLaG9qKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICAvLyBBZGQgbm90aWNlIHdoZXRoZXIgYWJsZSB0byBjb25uZWN0IHRvIGtob2ogYmFja2VuZCBvciBub3RcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ3NtYWxsJywgeyB0ZXh0OiB0aGlzLmdldEJhY2tlbmRTdGF0dXNNZXNzYWdlKCkgfSk7XG5cbiAgICAgICAgLy8gQWRkIGtob2ogc2V0dGluZ3MgY29uZmlndXJhYmxlIGZyb20gdGhlIHBsdWdpbiBzZXR0aW5ncyB0YWJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnS2hvaiBVUkwnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1RoZSBVUkwgb2YgdGhlIEtob2ogYmFja2VuZCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoYCR7dGhpcy5wbHVnaW4uc2V0dGluZ3Mua2hvalVybH1gKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mua2hvalVybCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lckVsLmZpcnN0RWxlbWVudENoaWxkPy5zZXRUZXh0KHRoaXMuZ2V0QmFja2VuZFN0YXR1c01lc3NhZ2UoKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVzdWx0cyBDb3VudCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnVGhlIG51bWJlciBvZiBzZWFyY2ggcmVzdWx0cyB0byBzaG93JylcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoMSwgMTAsIDEpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlc3VsdHNDb3VudClcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVzdWx0c0NvdW50ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgbGV0IGluZGV4VmF1bHRTZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpO1xuICAgICAgICBpbmRleFZhdWx0U2V0dGluZ1xuICAgICAgICAgICAgLnNldE5hbWUoJ0luZGV4IFZhdWx0JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNYW51YWxseSBmb3JjZSBLaG9qIHRvIHJlLWluZGV4IHlvdXIgT2JzaWRpYW4gVmF1bHQnKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1VwZGF0ZScpXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBEaXNhYmxlIGJ1dHRvbiB3aGlsZSB1cGRhdGluZyBpbmRleFxuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnVXBkYXRpbmcuLi4nKTtcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICAgICAgICAgICAgICBpbmRleFZhdWx0U2V0dGluZyA9IGluZGV4VmF1bHRTZXR0aW5nLnNldERpc2FibGVkKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlcXVlc3QoYCR7dGhpcy5wbHVnaW4uc2V0dGluZ3Mua2hvalVybH0vYXBpL3VwZGF0ZT90PW1hcmtkb3duJmZvcmNlPXRydWVgKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnXHUyNzA1IFVwZGF0ZWQgS2hvaiBpbmRleC4nKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZS1lbmFibGUgYnV0dG9uIG9uY2UgaW5kZXggaXMgdXBkYXRlZFxuICAgICAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnVXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXhWYXVsdFNldHRpbmcgPSBpbmRleFZhdWx0U2V0dGluZy5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgfVxuXG4gICAgZ2V0QmFja2VuZFN0YXR1c01lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29ubmVjdGVkVG9CYWNrZW5kXG4gICAgICAgID8gJ1x1Mjc1N0Rpc2Nvbm5lY3RlZCBmcm9tIEtob2ogYmFja2VuZC4gRW5zdXJlIEtob2ogYmFja2VuZCBpcyBydW5uaW5nIGFuZCBLaG9qIFVSTCBpcyBjb3JyZWN0bHkgc2V0IGJlbG93LidcbiAgICAgICAgOiAnXHUyNzA1IENvbm5lY3RlZCB0byBLaG9qIGJhY2tlbmQuJztcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBTdWdnZXN0TW9kYWwsIHJlcXVlc3QsIE1hcmtkb3duUmVuZGVyZXIsIEluc3RydWN0aW9uLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtob2pTZXR0aW5nIH0gZnJvbSAnc3JjL3NldHRpbmdzJztcblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hSZXN1bHQge1xuICAgIGVudHJ5OiBzdHJpbmc7XG4gICAgZmlsZTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgS2hvak1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPFNlYXJjaFJlc3VsdD4ge1xuICAgIHNldHRpbmc6IEtob2pTZXR0aW5nO1xuICAgIHJlcmFuazogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGZpbmRfc2ltaWxhcl9ub3RlczogYm9vbGVhbjtcbiAgICBhcHA6IEFwcDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBzZXR0aW5nOiBLaG9qU2V0dGluZywgZmluZF9zaW1pbGFyX25vdGVzOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuc2V0dGluZyA9IHNldHRpbmc7XG4gICAgICAgIHRoaXMuZmluZF9zaW1pbGFyX25vdGVzID0gZmluZF9zaW1pbGFyX25vdGVzO1xuXG4gICAgICAgIC8vIEhpZGUgaW5wdXQgZWxlbWVudCBpbiBTaW1pbGFyIE5vdGVzIG1vZGVcbiAgICAgICAgdGhpcy5pbnB1dEVsLmhpZGRlbiA9IHRoaXMuZmluZF9zaW1pbGFyX25vdGVzO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIE1vZGFsIEtleWJpbmRpbmdzIHRvIFJlcmFuayBSZXN1bHRzXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoWydNb2QnXSwgJ0VudGVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gUmUtcmFuayB3aGVuIGV4cGxpY2l0bHkgdHJpZ2dlcmVkIGJ5IHVzZXJcbiAgICAgICAgICAgIHRoaXMucmVyYW5rID0gdHJ1ZVxuICAgICAgICAgICAgLy8gVHJpZ2dlciBpbnB1dCBldmVudCB0byBnZXQgYW5kIHJlbmRlciAocmVyYW5rZWQpIHJlc3VsdHMgZnJvbSBraG9qIGJhY2tlbmRcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnKSk7XG4gICAgICAgICAgICAvLyBSZXJhbmsgZGlzYWJsZWQgYnkgZGVmYXVsdCB0byBzYXRpc2Z5IGxhdGVuY3kgcmVxdWlyZW1lbnRzIGZvciBpbmNyZW1lbnRhbCBzZWFyY2hcbiAgICAgICAgICAgIHRoaXMucmVyYW5rID0gZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWRkIEhpbnRzIHRvIE1vZGFsIGZvciBhdmFpbGFibGUgS2V5YmluZGluZ3NcbiAgICAgICAgY29uc3QgbW9kYWxJbnN0cnVjdGlvbnM6IEluc3RydWN0aW9uW10gPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ1x1MjE5MVx1MjE5MycsXG4gICAgICAgICAgICAgICAgcHVycG9zZTogJ3RvIG5hdmlnYXRlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ1x1MjFCNScsXG4gICAgICAgICAgICAgICAgcHVycG9zZTogJ3RvIG9wZW4nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb21tYW5kOiBQbGF0Zm9ybS5pc01hY09TID8gJ2NtZCBcdTIxQjUnIDogJ2N0cmwgXHUyMUI1JyxcbiAgICAgICAgICAgICAgICBwdXJwb3NlOiAndG8gcmVyYW5rJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ2VzYycsXG4gICAgICAgICAgICAgICAgcHVycG9zZTogJ3RvIGRpc21pc3MnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXVxuICAgICAgICB0aGlzLnNldEluc3RydWN0aW9ucyhtb2RhbEluc3RydWN0aW9ucyk7XG5cbiAgICAgICAgLy8gU2V0IFBsYWNlaG9sZGVyIFRleHQgZm9yIE1vZGFsXG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoJ1NlYXJjaCB3aXRoIEtob2ogXHVEODNFXHVERDg1Li4uJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICBpZiAodGhpcy5maW5kX3NpbWlsYXJfbm90ZXMpIHtcbiAgICAgICAgICAgIC8vIElmIG1hcmtkb3duIGZpbGUgaXMgY3VycmVudGx5IGFjdGl2ZVxuICAgICAgICAgICAgbGV0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgaWYgKGZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICAgICAgICAvLyBFbmFibGUgcmVyYW5rIG9mIHNlYXJjaCByZXN1bHRzXG4gICAgICAgICAgICAgICAgdGhpcy5yZXJhbmsgPSB0cnVlXG4gICAgICAgICAgICAgICAgLy8gU2V0IGlucHV0IGVsZW1lbnQgdG8gY29udGVudHMgb2YgYWN0aXZlIG1hcmtkb3duIGZpbGVcbiAgICAgICAgICAgICAgICAvLyB0cnVuY2F0ZSB0byBmaXJzdCA4LDAwMCBjaGFyYWN0ZXJzIHRvIGF2b2lkIGhpdHRpbmcgcXVlcnkgc2l6ZSBsaW1pdHNcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpLnRoZW4oZmlsZV9zdHIgPT4gZmlsZV9zdHIuc2xpY2UoMCwgODAwMCkpO1xuICAgICAgICAgICAgICAgIC8vIFRyaWdnZXIgc2VhcmNoIHRvIGdldCBhbmQgcmVuZGVyIHNpbWlsYXIgbm90ZXMgZnJvbSBraG9qIGJhY2tlbmRcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWwuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JykpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVyYW5rID0gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0Q29udGFpbmVyRWwuc2V0VGV4dCgnQ2Fubm90IGZpbmQgc2ltaWxhciBub3RlcyBmb3Igbm9uLW1hcmtkb3duIGZpbGVzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxTZWFyY2hSZXN1bHRbXT4ge1xuICAgICAgICAvLyBRdWVyeSBLaG9qIGJhY2tlbmQgZm9yIHNlYXJjaCByZXN1bHRzXG4gICAgICAgIGxldCBlbmNvZGVkUXVlcnkgPSBlbmNvZGVVUklDb21wb25lbnQocXVlcnkpO1xuICAgICAgICBsZXQgc2VhcmNoVXJsID0gYCR7dGhpcy5zZXR0aW5nLmtob2pVcmx9L2FwaS9zZWFyY2g/cT0ke2VuY29kZWRRdWVyeX0mbj0ke3RoaXMuc2V0dGluZy5yZXN1bHRzQ291bnR9JnI9JHt0aGlzLnJlcmFua30mdD1tYXJrZG93bmA7XG4gICAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3Qoc2VhcmNoVXJsKTtcbiAgICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3BvbnNlKTtcbiAgICAgICAgbGV0IHJlc3VsdHMgPSBkYXRhXG4gICAgICAgICAgICAuZmlsdGVyKChyZXN1bHQ6IGFueSkgPT4gIXRoaXMuZmluZF9zaW1pbGFyX25vdGVzIHx8ICFyZXN1bHQuYWRkaXRpb25hbC5maWxlLmVuZHNXaXRoKHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LnBhdGgpKVxuICAgICAgICAgICAgLm1hcCgocmVzdWx0OiBhbnkpID0+IHsgcmV0dXJuIHsgZW50cnk6IHJlc3VsdC5lbnRyeSwgZmlsZTogcmVzdWx0LmFkZGl0aW9uYWwuZmlsZSB9IGFzIFNlYXJjaFJlc3VsdDsgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVuZGVyU3VnZ2VzdGlvbihyZXN1bHQ6IFNlYXJjaFJlc3VsdCwgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGxldCB3b3Jkc190b19yZW5kZXIgPSAzMDtcbiAgICAgICAgbGV0IGVudHJ5X3dvcmRzID0gcmVzdWx0LmVudHJ5LnNwbGl0KCcgJylcbiAgICAgICAgbGV0IGVudHJ5X3NuaXBwZWRfaW5kaWNhdG9yID0gZW50cnlfd29yZHMubGVuZ3RoID4gd29yZHNfdG9fcmVuZGVyID8gJyAqKi4uLioqJyA6ICcnO1xuICAgICAgICBsZXQgc25pcHBlZF9lbnRyeSA9IGVudHJ5X3dvcmRzLnNsaWNlKDAsIHdvcmRzX3RvX3JlbmRlcikuam9pbignICcpO1xuICAgICAgICBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHNuaXBwZWRfZW50cnkgKyBlbnRyeV9zbmlwcGVkX2luZGljYXRvciwgZWwsIG51bGwsIG51bGwpO1xuICAgIH1cblxuICAgIGFzeW5jIG9uQ2hvb3NlU3VnZ2VzdGlvbihyZXN1bHQ6IFNlYXJjaFJlc3VsdCwgXzogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgLy8gR2V0IGFsbCBtYXJrZG93biBmaWxlcyBpbiB2YXVsdFxuICAgICAgICBjb25zdCBtZEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG4gICAgICAgIC8vIEZpbmQgdGhlIHZhdWx0IGZpbGUgbWF0Y2hpbmcgZmlsZSBvZiBjaG9zZW4gc2VhcmNoIHJlc3VsdFxuICAgICAgICBsZXQgZmlsZV9tYXRjaCA9IG1kRmlsZXNcbiAgICAgICAgICAgIC8vIFNvcnQgYnkgZGVzY2VuZGluZyBsZW5ndGggb2YgcGF0aFxuICAgICAgICAgICAgLy8gVGhpcyBmaW5kcyBsb25nZXN0IHBhdGggbWF0Y2ggd2hlbiBtdWx0aXBsZSBmaWxlcyBoYXZlIHNhbWUgbmFtZVxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIucGF0aC5sZW5ndGggLSBhLnBhdGgubGVuZ3RoKVxuICAgICAgICAgICAgLy8gVGhlIGZpcnN0IG1hdGNoIGlzIHRoZSBiZXN0IGZpbGUgbWF0Y2ggYWNyb3NzIE9TXG4gICAgICAgICAgICAvLyBlLmcgS2hvaiBzZXJ2ZXIgb24gTGludXgsIE9ic2lkaWFuIHZhdWx0IG9uIEFuZHJvaWRcbiAgICAgICAgICAgIC5maW5kKGZpbGUgPT4gcmVzdWx0LmZpbGUuZW5kc1dpdGgoZmlsZS5wYXRoKSlcblxuICAgICAgICAvLyBPcGVuIHZhdWx0IGZpbGUgYXQgaGVhZGluZyBvZiBjaG9zZW4gc2VhcmNoIHJlc3VsdFxuICAgICAgICBpZiAoZmlsZV9tYXRjaCl7XG4gICAgICAgICAgICBsZXQgcmVzdWx0SGVhZGluZyA9IHJlc3VsdC5lbnRyeS5zcGxpdCgnXFxuJywgMSlbMF07XG4gICAgICAgICAgICBsZXQgbGlua1RvRW50cnkgPSBgJHtmaWxlX21hdGNoLnBhdGh9JHtyZXN1bHRIZWFkaW5nfWBcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQobGlua1RvRW50cnksICcnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBMaW5rOiAke2xpbmtUb0VudHJ5fSwgRmlsZTogJHtmaWxlX21hdGNoLnBhdGh9LCBIZWFkaW5nOiAke3Jlc3VsdEhlYWRpbmd9YCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgRmlsZVN5c3RlbUFkYXB0ZXIsIE5vdGljZSwgUmVxdWVzdFVybFBhcmFtLCByZXF1ZXN0LCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtob2pTZXR0aW5nIH0gZnJvbSAnc3JjL3NldHRpbmdzJ1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VmF1bHRBYnNvbHV0ZVBhdGgodmF1bHQ6IFZhdWx0KTogc3RyaW5nIHtcbiAgICBsZXQgYWRhcHRvciA9IHZhdWx0LmFkYXB0ZXI7XG4gICAgaWYgKGFkYXB0b3IgaW5zdGFuY2VvZiBGaWxlU3lzdGVtQWRhcHRlcikge1xuICAgICAgICByZXR1cm4gYWRhcHRvci5nZXRCYXNlUGF0aCgpO1xuICAgIH1cbiAgICByZXR1cm4gJyc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25maWd1cmVLaG9qQmFja2VuZCh2YXVsdDogVmF1bHQsIHNldHRpbmc6IEtob2pTZXR0aW5nLCBub3RpZnk6IGJvb2xlYW4gPSB0cnVlKSB7XG4gICAgbGV0IG1kSW5WYXVsdCA9IGAke2dldFZhdWx0QWJzb2x1dGVQYXRoKHZhdWx0KX0vKiovKi5tZGA7XG4gICAgbGV0IGtob2pDb25maWdVcmwgPSBgJHtzZXR0aW5nLmtob2pVcmx9L2FwaS9jb25maWcvZGF0YWA7XG5cbiAgICAvLyBDaGVjayBpZiBraG9qIGJhY2tlbmQgaXMgY29uZmlndXJlZCwgbm90ZSBpZiBjYW5ub3QgY29ubmVjdCB0byBiYWNrZW5kXG4gICAgbGV0IGtob2pfYWxyZWFkeV9jb25maWd1cmVkID0gYXdhaXQgcmVxdWVzdChraG9qQ29uZmlnVXJsKVxuICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBzZXR0aW5nLmNvbm5lY3RlZFRvQmFja2VuZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgIT09IFwibnVsbFwiXG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICBzZXR0aW5nLmNvbm5lY3RlZFRvQmFja2VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKG5vdGlmeSlcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTI3NTdcdUZFMEZFbnN1cmUgS2hvaiBiYWNrZW5kIGlzIHJ1bm5pbmcgYW5kIEtob2ogVVJMIGlzIHBvaW50aW5nIHRvIGl0IGluIHRoZSBwbHVnaW4gc2V0dGluZ3MuXFxuXFxuJHtlcnJvcn1gKTtcbiAgICAgICAgfSlcbiAgICAvLyBTaG9ydC1jaXJjdWl0IGNvbmZpZ3VyaW5nIGtob2ogaWYgdW5hYmxlIHRvIGNvbm5lY3QgdG8ga2hvaiBiYWNrZW5kXG4gICAgaWYgKCFzZXR0aW5nLmNvbm5lY3RlZFRvQmFja2VuZCkgcmV0dXJuO1xuXG4gICAgLy8gU2V0IGluZGV4IG5hbWUgZnJvbSB0aGUgcGF0aCBvZiB0aGUgY3VycmVudCB2YXVsdFxuICAgIGxldCBpbmRleE5hbWUgPSBnZXRWYXVsdEFic29sdXRlUGF0aCh2YXVsdCkucmVwbGFjZSgvXFwvL2csICdfJykucmVwbGFjZSgvIC9nLCAnXycpO1xuICAgIC8vIEdldCBkZWZhdWx0IGluZGV4IGRpcmVjdG9yeSBmcm9tIGtob2ogYmFja2VuZFxuICAgIGxldCBraG9qRGVmYXVsdEluZGV4RGlyZWN0b3J5ID0gYXdhaXQgcmVxdWVzdChgJHtraG9qQ29uZmlnVXJsfS9kZWZhdWx0YClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gSlNPTi5wYXJzZShyZXNwb25zZSkpXG4gICAgICAgIC50aGVuKGRhdGEgPT4geyByZXR1cm4gZ2V0SW5kZXhEaXJlY3RvcnlGcm9tQmFja2VuZENvbmZpZyhkYXRhKTsgfSk7XG5cbiAgICAvLyBHZXQgY3VycmVudCBjb25maWcgaWYga2hvaiBiYWNrZW5kIGNvbmZpZ3VyZWQsIGVsc2UgZ2V0IGRlZmF1bHQgY29uZmlnIGZyb20ga2hvaiBiYWNrZW5kXG4gICAgYXdhaXQgcmVxdWVzdChraG9qX2FscmVhZHlfY29uZmlndXJlZCA/IGtob2pDb25maWdVcmwgOiBgJHtraG9qQ29uZmlnVXJsfS9kZWZhdWx0YClcbiAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gSlNPTi5wYXJzZShyZXNwb25zZSkpXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgLy8gSWYga2hvaiBiYWNrZW5kIG5vdCBjb25maWd1cmVkIHlldFxuICAgICAgICAgICAgaWYgKCFraG9qX2FscmVhZHlfY29uZmlndXJlZCkge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBraG9qIGNvbnRlbnQtdHlwZSBjb25maWcgd2l0aCBvbmx5IG1hcmtkb3duIGNvbmZpZ3VyZWRcbiAgICAgICAgICAgICAgICBkYXRhW1wiY29udGVudC10eXBlXCJdID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm1hcmtkb3duXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5wdXQtZmlsdGVyXCI6IFttZEluVmF1bHRdLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnB1dC1maWxlc1wiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWJlZGRpbmdzLWZpbGVcIjogYCR7a2hvakRlZmF1bHRJbmRleERpcmVjdG9yeX0vJHtpbmRleE5hbWV9LnB0YCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcHJlc3NlZC1qc29ubFwiOiBgJHtraG9qRGVmYXVsdEluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0uanNvbmwuZ3pgLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIERpc2FibGUga2hvaiBwcm9jZXNzb3JzLCBhcyBub3QgcmVxdWlyZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YVtcInByb2Nlc3NvclwiXTtcblxuICAgICAgICAgICAgICAgIC8vIFNhdmUgbmV3IGNvbmZpZyBhbmQgcmVmcmVzaCBpbmRleCBvbiBraG9qIGJhY2tlbmRcbiAgICAgICAgICAgICAgICB1cGRhdGVLaG9qQmFja2VuZChzZXR0aW5nLmtob2pVcmwsIGRhdGEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBLaG9qOiBDcmVhdGVkIGtob2ogYmFja2VuZCBjb25maWc6XFxuJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBFbHNlIGlmIGtob2ogY29uZmlnIGhhcyBubyBtYXJrZG93biBjb250ZW50IGNvbmZpZ1xuICAgICAgICAgICAgZWxzZSBpZiAoIWRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXSkge1xuICAgICAgICAgICAgICAgIC8vIEFkZCBtYXJrZG93biBjb25maWcgdG8ga2hvaiBjb250ZW50LXR5cGUgY29uZmlnXG4gICAgICAgICAgICAgICAgLy8gU2V0IG1hcmtkb3duIGNvbmZpZyB0byBpbmRleCBtYXJrZG93biBmaWxlcyBpbiBjb25maWd1cmVkIG9ic2lkaWFuIHZhdWx0XG4gICAgICAgICAgICAgICAgZGF0YVtcImNvbnRlbnQtdHlwZVwiXVtcIm1hcmtkb3duXCJdID0ge1xuICAgICAgICAgICAgICAgICAgICBcImlucHV0LWZpbHRlclwiOiBbbWRJblZhdWx0XSxcbiAgICAgICAgICAgICAgICAgICAgXCJpbnB1dC1maWxlc1wiOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBcImVtYmVkZGluZ3MtZmlsZVwiOiBgJHtraG9qRGVmYXVsdEluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0ucHRgLFxuICAgICAgICAgICAgICAgICAgICBcImNvbXByZXNzZWQtanNvbmxcIjogYCR7a2hvakRlZmF1bHRJbmRleERpcmVjdG9yeX0vJHtpbmRleE5hbWV9Lmpzb25sLmd6YCxcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTYXZlIHVwZGF0ZWQgY29uZmlnIGFuZCByZWZyZXNoIGluZGV4IG9uIGtob2ogYmFja2VuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUtob2pCYWNrZW5kKHNldHRpbmcua2hvalVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEtob2o6IEFkZGVkIG1hcmtkb3duIGNvbmZpZyB0byBraG9qIGJhY2tlbmQgY29uZmlnOlxcbiR7SlNPTi5zdHJpbmdpZnkoZGF0YVtcImNvbnRlbnQtdHlwZVwiXSl9YClcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRWxzZSBpZiBraG9qIGlzIG5vdCBjb25maWd1cmVkIHRvIGluZGV4IG1hcmtkb3duIGZpbGVzIGluIGNvbmZpZ3VyZWQgb2JzaWRpYW4gdmF1bHRcbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXVtcImlucHV0LWZpbHRlclwiXS5sZW5ndGggIT0gMSB8fFxuICAgICAgICAgICAgICAgIGRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXVtcImlucHV0LWZpbHRlclwiXVswXSAhPT0gbWRJblZhdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIG1hcmtkb3duIGNvbmZpZyBpbiBraG9qIGNvbnRlbnQtdHlwZSBjb25maWdcbiAgICAgICAgICAgICAgICAvLyBTZXQgbWFya2Rvd24gY29uZmlnIHRvIG9ubHkgaW5kZXggbWFya2Rvd24gZmlsZXMgaW4gY29uZmlndXJlZCBvYnNpZGlhbiB2YXVsdFxuICAgICAgICAgICAgICAgIGxldCBraG9qSW5kZXhEaXJlY3RvcnkgPSBnZXRJbmRleERpcmVjdG9yeUZyb21CYWNrZW5kQ29uZmlnKGRhdGEpO1xuICAgICAgICAgICAgICAgIGRhdGFbXCJjb250ZW50LXR5cGVcIl1bXCJtYXJrZG93blwiXSA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJpbnB1dC1maWx0ZXJcIjogW21kSW5WYXVsdF0sXG4gICAgICAgICAgICAgICAgICAgIFwiaW5wdXQtZmlsZXNcIjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgXCJlbWJlZGRpbmdzLWZpbGVcIjogYCR7a2hvakluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0ucHRgLFxuICAgICAgICAgICAgICAgICAgICBcImNvbXByZXNzZWQtanNvbmxcIjogYCR7a2hvakluZGV4RGlyZWN0b3J5fS8ke2luZGV4TmFtZX0uanNvbmwuZ3pgLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBTYXZlIHVwZGF0ZWQgY29uZmlnIGFuZCByZWZyZXNoIGluZGV4IG9uIGtob2ogYmFja2VuZFxuICAgICAgICAgICAgICAgIHVwZGF0ZUtob2pCYWNrZW5kKHNldHRpbmcua2hvalVybCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEtob2o6IFVwZGF0ZWQgbWFya2Rvd24gY29uZmlnIGluIGtob2ogYmFja2VuZCBjb25maWc6XFxuJHtKU09OLnN0cmluZ2lmeShkYXRhW1wiY29udGVudC10eXBlXCJdW1wibWFya2Rvd25cIl0pfWApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICBpZiAobm90aWZ5KVxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1Mjc1N1x1RkUwRkZhaWxlZCB0byBjb25maWd1cmUgS2hvaiBiYWNrZW5kLiBDb250YWN0IGRldmVsb3BlciBvbiBHaXRodWIuXFxuXFxuRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVLaG9qQmFja2VuZChraG9qVXJsOiBzdHJpbmcsIGtob2pDb25maWc6IE9iamVjdCkge1xuICAgIC8vIFBPU1Qga2hvakNvbmZpZyB0byBraG9qQ29uZmlnVXJsXG4gICAgbGV0IHJlcXVlc3RDb250ZW50OiBSZXF1ZXN0VXJsUGFyYW0gPSB7XG4gICAgICAgIHVybDogYCR7a2hvalVybH0vYXBpL2NvbmZpZy9kYXRhYCxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoa2hvakNvbmZpZyksXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgIH07XG5cbiAgICAvLyBTYXZlIGtob2pDb25maWcgb24ga2hvaiBiYWNrZW5kIGF0IGtob2pDb25maWdVcmxcbiAgICBhd2FpdCByZXF1ZXN0KHJlcXVlc3RDb250ZW50KVxuICAgICAgICAvLyBSZWZyZXNoIGtob2ogc2VhcmNoIGluZGV4IGFmdGVyIHVwZGF0aW5nIGNvbmZpZ1xuICAgICAgICAudGhlbihfID0+IHJlcXVlc3QoYCR7a2hvalVybH0vYXBpL3VwZGF0ZT90PW1hcmtkb3duYCkpO1xufVxuXG5mdW5jdGlvbiBnZXRJbmRleERpcmVjdG9yeUZyb21CYWNrZW5kQ29uZmlnKGtob2pDb25maWc6IGFueSkge1xuICAgIHJldHVybiBraG9qQ29uZmlnW1wiY29udGVudC10eXBlXCJdW1wibWFya2Rvd25cIl1bXCJlbWJlZGRpbmdzLWZpbGVcIl0uc3BsaXQoXCIvXCIpLnNsaWNlKDAsIC0xKS5qb2luKFwiL1wiKTtcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQStCOzs7QUNBL0Isc0JBQWdFO0FBU3pELElBQU0sbUJBQWdDO0FBQUEsRUFDekMsY0FBYztBQUFBLEVBQ2QsU0FBUztBQUFBLEVBQ1Qsb0JBQW9CO0FBQ3hCO0FBRU8sSUFBTSxpQkFBTixjQUE2QixpQ0FBaUI7QUFBQSxFQUdqRCxZQUFZLEtBQVUsUUFBYztBQUNoQyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsVUFBZ0I7QUFDWixVQUFNLEVBQUUsZ0JBQWdCO0FBQ3hCLGdCQUFZLE1BQU07QUFHbEIsZ0JBQVksU0FBUyxTQUFTLEVBQUUsTUFBTSxLQUFLLHdCQUF3QixFQUFFLENBQUM7QUFHdEUsUUFBSSx3QkFBUSxXQUFXLEVBQ2xCLFFBQVEsVUFBVSxFQUNsQixRQUFRLDZCQUE2QixFQUNyQyxRQUFR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
